# 组件设计原则

如何设计一个高质量的组件和组件库是一个涉及架构设计、工程化配置和代码规范的综合过程。下面将介绍一些组件设计原则。

## 组件设计的基本原则

我们在编写单个组件时，应遵循以下原则：

- 单一职责：一个组件只做一件事
- Props定义清晰：使用`TypeScript`定义严格的类型，并提供合理的默认值
- 事件规范：使用`emits`显式声明组件触发的事件
- 插槽(Slots)灵活性：通过具名插槽提供高度定义化的能力
- 样式隔离：使用`BEM`命名规范或`Scoped CSS`，避免样式污染
- 无状态 vs 有状态：组件应该尽量保持为“纯组件”，通过`Props`驱动UI，状态管理交给父组件

## 组件库的架构设计

推荐使用Monorepo架构，将组件库拆分成多个包，每个包独立管理，通过`pnpm`或`yarn`管理依赖。

```bash
my-component/
├── packages/                # 组件源码目录
│   ├── components/         # 组件
│   │   ├── Button/        # 按钮组件
│   │   └── index.ts       # 组件统一导出
│   ├── theme/             # 全局样式
│   ├── hooks/             # 组合式函数
│   ├── utils/             # 工具函数
│   └── types/             # 类型定义
├── docs/                 # 使用 VitePress 或 dumi 编写的文档
├── example/              # 本地调试示例
├── package.json
└── pnpm-workspace.yaml
```

**构建工具**

使用`vite`或者`Rollup`作为构建工具，`vite`构建速度快，且内置了对库模式的良好支持。`Rollup`功能更强大，适合复杂场景。

**样式隔离**

- 使用`BEM`命名规范或`Scoped CSS`，避免样式污染。

- 使用`CSS Variables`来实现主题切换。

**文档与演示**

一个好的组件库必须有详尽的文档和演示，方便用户使用。

- 可以使用`VitePress`，非常适合编写Vue组件库文档
- 自己搭建一个静态站点，可以添加演示的交互和实时预览

**发布和维护**

- 语义化版本 (SemVer)：严格遵守 Major.Minor.Patch 版本规范。
- 按需引入：支持 Tree-shaking，导出 ES Module 格式，方便用户减小打包体积。
- 自动化流：使用 GitHub Actions 进行自动化测试和发布。