---
tag:
 - React åç®¡
---

# ï¼ˆå…­ï¼‰ï¼šä¸»é¢˜é…ç½®

## å‰è¨€

ä¸»é¢˜é…ç½®æ˜¯æ¯ä¸ªåå°ç®¡ç†ç³»ç»Ÿçš„æ ‡é…åŠŸèƒ½ã€‚åœ¨ç³»ç»Ÿå³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¸»é¢˜é…ç½®æŠ½å±‰ã€‚ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œè°ƒæ•´å„ç§ä¸»é¢˜ç›¸å…³çš„é…ç½®ï¼ŒåŒ…æ‹¬æš—é»‘æ¨¡å¼ã€ä¸»é¢˜è‰²ã€ç°è‰²æ¨¡å¼ç­‰ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜è€ƒè™‘åˆ°äº†ä¸€äº›ç‰¹æ®Šåœºæ™¯ï¼šè‰²å¼±æ¨¡å¼èƒ½è®©è‰²å¼±ç”¨æˆ·æ›´å¥½åœ°åˆ†è¾¨ç•Œé¢å†…å®¹ï¼›ç´§å‡‘æ¨¡å¼é€‚åˆåœ¨å°å±è®¾å¤‡ä¸Šä½¿ç”¨ï¼›è¿˜å¯ä»¥è°ƒæ•´ç»„ä»¶çš„åœ†è§’å¤§å°ï¼Œæ¥æ»¡è¶³ä¸åŒçš„å®¡ç¾éœ€æ±‚ã€‚

è¿™äº›é…ç½®éƒ½ä¼šä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå³ä½¿åˆ·æ–°é¡µé¢ä¹Ÿèƒ½ä¿æŒä¸€è‡´ã€‚ç”¨æˆ·ä¸éœ€è¦æ¯æ¬¡è¿›å…¥ç³»ç»Ÿéƒ½é‡æ–°è®¾ç½®ã€‚

## å®ç°æ–¹æ¡ˆ

ç›®å‰ä¸»æµçš„ä¸»é¢˜å®ç°æ–¹æ¡ˆæœ‰ï¼šCSS ç±»ååˆ‡æ¢ã€CSS å˜é‡ã€CSS in JS ç­‰ã€‚åœ¨ç»è¿‡æŠ€æœ¯è°ƒç ”åï¼Œå‚ç…§äº† Ant Design ã€çŸ¥ä¹ ã€æ˜é‡‘ç­‰ç½‘ç«™çš„å®ç°æ–¹å¼ï¼Œæœ€ç»ˆé‡‡ç”¨äº†æ··åˆæ–¹æ¡ˆï¼ˆCSSå˜é‡ + ç±»ååˆ‡æ¢ + JavaScript æ§åˆ¶ï¼‰ï¼Œæœ€å¤§é™åº¦ç»“åˆäº†å¤šç§æ–¹æ¡ˆçš„ä¼˜ç‚¹ã€‚

å¯ä»¥å‚è€ƒæˆ‘å¦ä¸€ç¯‡æ–‡ç« ï¼š[å‰ç«¯ä¸»é¢˜åˆ‡æ¢å®ç°æ–¹æ¡ˆå¯¹æ¯”](/éšç¬”/cssThere.md)

## å®‰è£…ä¾èµ–

```bash
# ant design å¿«ä¹å·¥ä½œä¸»é¢˜
npm install @ant-design/happy-work-theme

# é¢œè‰²é€‰æ‹©å™¨
npm install react-colorful
```

## 1. æ ¸å¿ƒæ–‡ä»¶ç»“æ„

```bash
â”œâ”€â”€ hooks/                 # å…¨å±€é’©å­å‡½æ•°
â”‚   â””â”€â”€ useTheme.ts        # ä¸»é¢˜åˆ‡æ¢æ ¸å¿ƒé€»è¾‘
â”œâ”€â”€ styles/                # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ index.less         # ä¸»æ ·å¼å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ transition.less    # è¿‡æ¸¡åŠ¨ç”»æ ·å¼
â”‚   â”œâ”€â”€ proTable.less      # ProTable ç»„ä»¶æ ·å¼
â”‚   â”œâ”€â”€ common.less        # é€šç”¨æ ·å¼
â”‚   â””â”€â”€ theme/             # ä¸»é¢˜ç›¸å…³é…ç½®
â”‚       â”œâ”€â”€ sider.ts       # ä¾§è¾¹æ ä¸»é¢˜é…ç½®
â”‚       â”œâ”€â”€ header.ts      # å¤´éƒ¨ä¸»é¢˜é…ç½®
â”‚       â””â”€â”€ global.ts      # å…¨å±€ä¸»é¢˜é…ç½®
â””â”€â”€ utils/
    â””â”€â”€ color.ts             # é¢œè‰²å¤„ç†å·¥å…·
```

## 2. CSSå˜é‡å®šä¹‰

è¿™é‡Œä»¥ `src/styles/theme/global.ts` æ–‡ä»¶ä¸ºä¾‹ï¼Œå®šä¹‰äº†å…¨å±€ä¸»é¢˜é…ç½®ï¼š

```ts
/**
 * @description å…¨å±€ä¸»é¢˜é…ç½®
 */
const globalTheme = {
  light: {
    // è‡ªå®šä¹‰å…¨å±€CSSå˜é‡
    "--hooks-colorBgContent": "#f5f5f5",
    "--hooks-colorLogoText": "#475768",
    "--hooks-colorTextRegular": "#606266",
    "--hooks-boxShadowAnalysis": "0 5px 20px 0 rgb(50 50 50 / 54%)",
    "--hooks-scrollbarThumb": "rgba(0, 0, 0, 0.1)",
    // è‡ªå®šä¹‰ç™»å½•CSSå˜é‡
    "--hooks-colorBgLoginContainer": "#eeeeee",
    "--hooks-colorBgLoginMain": "rgb(255 255 255 / 80%)",
    "--hooks-boxShadowLoginForm": "0 2px 10px 2px rgb(0 0 0 / 10%)"
  },
  dark: {
    // è‡ªå®šä¹‰å…¨å±€CSSå˜é‡
    "--hooks-colorBgContent": "#0d0d0d",
    "--hooks-colorLogoText": "#f1f1f1",
    "--hooks-colorTextRegular": "#CFD3DC",
    "--hooks-boxShadowAnalysis": "0 3px 20px 0 rgb(255 255 255 / 35%)",
    "--hooks-scrollbarThumb": "rgba(255, 255, 255, 0.1)",
    // è‡ªå®šä¹‰ç™»å½•CSSå˜é‡
    "--hooks-colorBgLoginContainer": "#191919",
    "--hooks-colorBgLoginMain": "rgb(0 0 0 / 80%)",
    "--hooks-boxShadowLoginForm": "0 2px 10px 2px rgb(255 255 255 / 12%)"
  }
};

export default globalTheme;

```

## 3. ä¸»é¢˜è®¾ç½®å…¥å£

ç³»ç»Ÿå³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®ä¸­ï¼Œæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªä¸»é¢˜é…ç½®æŠ½å±‰ã€‚ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œè°ƒæ•´å„ç§ä¸»é¢˜ç›¸å…³çš„é…ç½®ã€‚

```tsx
// src/layouts/components/ThemeDrawer.tsx
import { setGlobalState } from "@/redux/modules/global";
import { RootState, useDispatch, useSelector } from "@/redux";

const ThemeDrawer: React.FC = () => {
  const dispatch = useDispatch();
  // çœç•¥å…¶ä»–ä»£ç 
  return (
    <Drawer>
      <Divider className="divider">
        <FireOutlined />
        å…¨å±€ä¸»é¢˜
      </Divider>
      <div className="theme-item">
        <span>ä¸»é¢˜é¢œè‰²</span>
        <Popover placement="left" trigger="click" content={ColorPicker}>
          <label className="primary"></label>
        </Popover>
      </div>
      <div className="theme-item">
        <span>æš—é»‘æ¨¡å¼</span>
        <Switch
          checked={isDark}
          checkedChildren={<span className="dark-icon dark-icon-sun">ğŸŒ</span>}
          unCheckedChildren={<span className="dark-icon dark-icon-moon">ğŸŒ›</span>}
          onChange={value => dispatch(setGlobalState({ key: "isDark", value }))}
        />
      </div>
      <div className="theme-item">
        <span>ç°è‰²æ¨¡å¼</span>
        <Switch
          checked={isGrey}
          onChange={value => {
            if (isWeak) dispatch(setGlobalState({ key: "isWeak", value: false }));
            dispatch(setGlobalState({ key: "isGrey", value }));
          }}
        />
      </div>
      <div className="theme-item">
        <span>è‰²å¼±æ¨¡å¼</span>
        <Switch
          checked={isWeak}
          onChange={value => {
            if (isGrey) dispatch(setGlobalState({ key: "isGrey", value: false }));
            dispatch(setGlobalState({ key: "isWeak", value }));
          }}
        />
      </div>
      <div className="theme-item">
        <span>å¿«ä¹æ¨¡å¼</span>
        <Switch checked={isHappy} onChange={value => dispatch(setGlobalState({ key: "isHappy", value }))} />
      </div>
      <div className="theme-item">
        <span>ç´§å‡‘ä¸»é¢˜</span>
        <Switch checked={compactAlgorithm} onChange={value => dispatch(setGlobalState({ key: "compactAlgorithm", value }))} />
      </div>
      <div className="theme-item mb35">
        <span>åœ†è§’å¤§å°</span>
        <InputNumber
          min={1}
          max={20}
          style={{ width: 80 }}
          defaultValue={borderRadius}
          formatter={value => `${value}px`}
          parser={value => (value ? value!.replace("px", "") : 6) as number}
          onChange={value => {
            const newValue = value || 6;
            dispatch(setGlobalState({ key: "borderRadius", value: newValue }));
          }}
        />
      </div>
    </Drawer>
  )
}

```

## 4. å…¨å±€ä¸»é¢˜çŠ¶æ€ç®¡ç†

åœ¨ `src/redux/modules/global.ts` æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å®šä¹‰äº†å…¨å±€ä¸»é¢˜çŠ¶æ€ç®¡ç†ï¼š

```ts
// src/redux/modules/global.ts
import { createSlice, PayloadAction } from "@reduxjs/toolkit";
import { GlobalState } from "@/redux/interface";
import { DEFAULT_PRIMARY } from "@/config";

const globalState: GlobalState = {
  // æ˜¯å¦å¼€å¯æš—é»‘ä¸»é¢˜
  isDark: false,
  // ä¸»é¢˜è‰²
  primary: DEFAULT_PRIMARY,
  // æ˜¯å¦å¼€å¯ç°è‰²æ¨¡å¼
  isGrey: false,
  // æ˜¯å¦å¼€å¯å¼±è‰²æ¨¡å¼
  isWeak: false,
  // æ˜¯å¦å¼€å¯å¼€å¿ƒæ¨¡å¼
  isHappy: false,
  // æ˜¯å¦å¼€å¯ç´§å‡‘æ¨¡å¼
  compactAlgorithm: false,
  // æ˜¯å¦å¼€å¯åœ†è§’æ¨¡å¼
  borderRadius: 4,
  // ç»„ä»¶å¤§å°
  componentSize: "middle"
}
```

## 5. ä¸»é¢˜ Hooks

åœ¨ `src/hooks/useTheme.ts` æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å†™äº†ä¸€ä¸ª Hook è®¾ç½®å…¨å±€ä¸»é¢˜ã€‚å¹¶ä¸”åœ¨ `src/router/index.ts` è·¯ç”±ä¸»å…¥å£æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨è°ƒç”¨äº† `useTheme` é’©å­å‡½æ•°ã€‚

```ts
const useTheme = () => {
  useEffect(() => switchDark(), [isDark]);
  useEffect(() => changePrimary(), [primary, borderRadius, compactAlgorithm]);
  useEffect(() => changeGreyOrWeak(), [isGrey, isWeak]);
  useEffect(() => changeSiderTheme(), [isDark, siderInverted]);
  useEffect(() => changeHeaderTheme(), [isDark, headerInverted]);
}
export default useTheme;
```

useTheme é’©å­å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨ useEffect ç›‘å¬ä¸»é¢˜ç›¸å…³çŠ¶æ€å˜åŒ–ï¼Œå¹¶è°ƒç”¨ç›¸åº”çš„å‡½æ•°è¿›è¡Œå¤„ç†ã€‚æ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€æ­¥æ­¥å®ç°è¿™äº›å‡½æ•°ã€‚

### 5.1 ä¸»é¢˜çŠ¶æ€ç®¡ç†

é¦–å…ˆï¼Œæˆ‘ä»¬ä» Redux ä¸­è·å–ä¸»é¢˜ç›¸å…³çŠ¶æ€ã€‚ä¸ºäº†é¿å…é¢‘ç¹è§¦å‘æ¸²æŸ“ï¼Œæˆ‘ä»¬ä½¿ç”¨ `shallowEqual` è¿›è¡Œæµ…æ¯”è¾ƒã€‚

```ts
const { 
  isDark,            // æš—é»‘æ¨¡å¼
  primary,           // ä¸»é¢˜è‰²
  isGrey,            // ç°åº¦æ¨¡å¼
  isWeak,            // å¼±è‰²æ¨¡å¼
  borderRadius,      // è¾¹æ¡†åœ†è§’
  compactAlgorithm,  // ç´§å‡‘ç®—æ³•
  siderInverted,     // ä¾§è¾¹æ åè½¬
  headerInverted     // å¤´éƒ¨åè½¬
} = useSelector(
    (state: RootState) => ({
    isDark: state.global.isDark,
    primary: state.global.primary,
    isGrey: state.global.isGrey,
    isWeak: state.global.isWeak,
    borderRadius: state.global.borderRadius,
    compactAlgorithm: state.global.compactAlgorithm,
    siderInverted: state.global.siderInverted,
    headerInverted: state.global.headerInverted
  }),
  shallowEqual
);
```

### 5.2 åˆ‡æ¢æš—é»‘æ¨¡å¼

åˆ‡æ¢æ¨¡å¼æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆåˆ‡æ¢ `html` æ ‡ç­¾çš„ `class` å±æ€§ï¼Œç„¶åè°ƒç”¨ `changePrimary` å‡½æ•°æ›´æ–°ä¸»é¢˜è‰²ã€‚

```ts
const switchDark = () => {
  const html = document.documentElement;
  html.setAttribute("class", isDark ? "dark" : "");
  changePrimary();
};
```

### 5.3 ä¸»é¢˜è‰²åˆ‡æ¢å®ç°ï¼ˆæ ¸å¿ƒï¼‰

è¿™ä¸ª`changePrimary`å‡½æ•°æ˜¯ä¸»é¢˜è‰²åˆ‡æ¢çš„æ ¸å¿ƒï¼Œä¸»é¢˜åˆ‡æ¢åœ¨è¿™ä¸ªå‡½æ•°ä¸­å®ç°ã€‚

æˆ‘ä»¬é¦–å…ˆæ ¹æ® `isDark` çŠ¶æ€ç¡®å®šå½“å‰ä¸»é¢˜ç±»å‹ï¼Œ

è®¾ç½®å…¨å±€ä¸»é¢˜å˜é‡ï¼Œé€šè¿‡ `setStyleProperty` å‡½æ•°å°†å®šä¹‰åœ¨ theme/global.ts ä¸­çš„CSSå˜é‡è®¾ç½®åˆ°`html`æ ‡ç­¾ä¸Š ,ä¾‹å¦‚è®¾ç½®--hooks-colorBgContent: #0d0d0d (æš—é»‘æ¨¡å¼)

è®¾ç½® Ant Design ä¸»é¢˜å˜é‡ï¼ŒAnt Design æœ‰ä¸€å¥— Token ç³»ç»Ÿï¼Œæˆ‘ä»¬é€šè¿‡ `setStyleProperty` å‡½æ•°è®¾ç½® Ant Design ä¸»é¢˜å˜é‡ï¼Œä¾‹å¦‚å°† colorPrimary: "#1890ff" è®¾ç½®ä¸º --hooks-colorPrimary: #1890ff

ç”Ÿæˆä¸»é¢˜è‰²çš„æ¸å˜è‰²é˜¶ï¼ŒAnt Design çš„ primary ä¸»é¢˜è‰²ä¸€å…±æœ‰ 9 ä¸ªæ¸å˜è‰²é˜¶ï¼Œé€šè¿‡ä¸Šé¢çš„æ–¹æ³•å·²ç»è½¬æ¢ä¸º `--hooks-colorPrimary1: #e6f7ff` åˆ° `--hooks-colorPrimary9: #002fa3`,ç„¶åæˆ‘ä»¬æ ¹æ®`isDark`çŠ¶æ€ï¼Œé€šè¿‡`getDarkColor`å’Œ`getLightColor`å‡½æ•°ç”Ÿæˆä¸åŒä¸»é¢˜ä¸‹ä¸»é¢˜è‰²çš„æ¸å˜è‰²é˜¶ã€‚ï¼ˆè§£å†³æš—é»‘æ¨¡å¼ä¸‹çš„é¢œè‰²é€‚é…é—®é¢˜ï¼‰

CSS å˜é‡ä¼šç«‹å³ç”Ÿæ•ˆï¼Œå®ç°å®æ—¶ä¸»é¢˜åˆ‡æ¢ã€‚

```ts
const changePrimary = () => {
  const type: ThemeType = isDark ? "dark" : "light";
  
  // 1. è®¾ç½®å…¨å±€ä¸»é¢˜å˜é‡
  Object.entries(globalTheme[type]).forEach(([key, val]) => {
    setStyleProperty(key, val);
  });

  // 2. è®¾ç½® Ant Design ä¸»é¢˜å˜é‡
  Object.entries(token).forEach(([key, val]) => {
    setStyleProperty(`--hooks-${key}`, val);
  });

  // 3. è®¾ç½® Ant Design primary ä¸»é¢˜è‰²çš„æ¸å˜è‰²é˜¶ï¼ˆä» 1-9 å…±ä¹ä¸ªå±‚çº§ï¼‰
  for (let i = 1; i <= 9; i++) {
    setStyleProperty(
      `--hooks-colorPrimary${i}`,
      isDark 
        ? getDarkColor(primary, i / 10)
        : getLightColor(primary, i / 10)
    );
  }
};
```

**é¢œè‰²å¤„ç†å·¥å…·**
```ts
// utils/color.ts

/**
 * @description è®¾ç½®æ ·å¼å±æ€§
 * @param {String} key - æ ·å¼å±æ€§å
 * @param {String} val - æ ·å¼å±æ€§å€¼
 */
export function setStyleProperty(key: string, val: string) {
  document.documentElement.style.setProperty(key, val);
}

/**
 * @description å°†åå…­è¿›åˆ¶é¢œè‰²è½¬æ¢ä¸ºRGBé¢œè‰²
 * @param {String} str é¢œè‰²å€¼å­—ç¬¦ä¸²
 * @returns {String} å¤„ç†åçš„é¢œè‰²å€¼
 */
export function hexToRgb(str: string) {
  let hexs: any = "";
  let reg = /^#?[0-9A-Fa-f]{6}$/;
  if (!reg.test(str)) return message.warning("Enter wrong hex color value");
  str = str.replace("#", "");
  hexs = str.match(/../g);
  for (let i = 0; i < 3; i++) hexs[i] = parseInt(hexs[i], 16);
  return hexs;
}

/**
 * @description å°†RGBé¢œè‰²è½¬æ¢ä¸ºåå…­è¿›åˆ¶é¢œè‰²
 * @param {*} r çº¢è‰²
 * @param {*} g ç»¿è‰²
 * @param {*} b è“è‰²
 * @returns {String} å¤„ç†åçš„é¢œè‰²å€¼
 */
export function rgbToHex(r: any, g: any, b: any) {
  let reg = /^\d{1,3}$/;
  if (!reg.test(r) || !reg.test(g) || !reg.test(b)) return message.warning("Enter wrong rgb color value");
  let hexs = [r.toString(16), g.toString(16), b.toString(16)];
  for (let i = 0; i < 3; i++) if (hexs[i].length == 1) hexs[i] = `0${hexs[i]}`;
  return `#${hexs.join("")}`;
}

/**
 * @description åŠ æ·±é¢œè‰²å€¼
 * @param {String} color é¢œè‰²å€¼å­—ç¬¦ä¸²
 * @param {Number} level æ·±åŒ–çš„ç¨‹åº¦ï¼Œé™åˆ¶åœ¨0-1ä¹‹é—´
 * @returns {String} å¤„ç†åçš„é¢œè‰²å€¼
 */
export function getDarkColor(color: string, level: number) {
  let reg = /^#?[0-9A-Fa-f]{6}$/;
  if (!reg.test(color)) return message.warning("Enter wrong hex color value");
  let rgb = hexToRgb(color);
  for (let i = 0; i < 3; i++) rgb[i] = Math.round(20.5 * level + rgb[i] * (1 - level));
  return rgbToHex(rgb[0], rgb[1], rgb[2]);
}

/**
 * @description æµ…åŒ–é¢œè‰²å€¼
 * @param {String} color é¢œè‰²å€¼å­—ç¬¦ä¸²
 * @param {Number} level æ·±åŒ–çš„ç¨‹åº¦ï¼Œé™åˆ¶åœ¨0-1ä¹‹é—´
 * @returns {String} å¤„ç†åçš„é¢œè‰²å€¼
 */
export function getLightColor(color: string, level: number) {
  let reg = /^#?[0-9A-Fa-f]{6}$/;
  if (!reg.test(color)) message.warning("Enter wrong hex color value");
  let rgb = hexToRgb(color);
  for (let i = 0; i < 3; i++) rgb[i] = Math.round(255 * level + rgb[i] * (1 - level));
  return rgbToHex(rgb[0], rgb[1], rgb[2]);
}
```

### 5.4 ç°è‰²æ¨¡å¼å’Œå¼±è‰²æ¨¡å¼

ç°è‰²æ¨¡å¼å’Œå¼±è‰²æ¨¡å¼æ˜¯ä¸¤ç§ä¸åŒçš„ä¸»é¢˜æ¨¡å¼ï¼Œå®ƒä»¬é€šè¿‡ `changeGreyOrWeak` å‡½æ•°å®ç°ã€‚æ ¸å¿ƒæ˜¯CSSçš„filterå±æ€§ã€‚`invert` å’Œ `grayscale` æ˜¯ä¸¤ä¸ªå¸¸ç”¨çš„æ»¤é•œå‡½æ•°ã€‚

```ts
const changeGreyOrWeak = () => {
  const html = document.documentElement;
  html.style.filter = isWeak ? "invert(80%)" : isGrey ? "grayscale(1)" : "";
};
```

### 5.5 ä¾§è¾¹æ å’Œå¤´éƒ¨ä¸»é¢˜

ä¾§è¾¹æ å’Œå¤´éƒ¨ä¸»é¢˜é€šè¿‡ `changeSiderTheme` å’Œ `changeHeaderTheme` å‡½æ•°å®ç°ã€‚

```ts
const changeSiderTheme = () => {
  const type: ThemeType = isDark ? "dark" : siderInverted ? "inverted" : "light";
  Object.entries(siderTheme[type]).forEach(([key, val]) => setStyleProperty(key, val));
};
  const changeHeaderTheme = () => {
  const type: ThemeType = isDark ? "dark" : headerInverted ? "inverted" : "light";
  Object.entries(headerTheme[type]).forEach(([key, val]) => setStyleProperty(key, val));
};
```

## 6. å¿«ä¹å·¥ä½œä¸»é¢˜

è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„ä¸»é¢˜ï¼Œå¼€å¿ƒå°±å®Œäº‹äº†ã€‚

è®©æˆ‘ä»¬å…ˆå®‰è£…ä¾èµ–

```bash
npm install @ant-design/happy-work-theme
```

ç„¶åé€šè¿‡HappyProvider ç»„ä»¶åŒ…è£¹æ•´ä¸ªåº”ç”¨ï¼Œå°±å¯ä»¥å®ç°å¿«ä¹å·¥ä½œä¸»é¢˜ã€‚

```tsx
import { HappyProvider } from '@ant-design/happy-work-theme';

export default () => (
  <HappyProvider>
    <Button />
  </HappyProvider>
);
```

## 7. å…¶ä»–ä¸»é¢˜è®¾ç½®

ä¾‹å¦‚ç´§å‡‘æ¨¡å¼ï¼Œåœ†è§’æ¨¡å¼ï¼Œç»„ä»¶å¤§å°ç­‰ï¼Œè¿™äº›å¯ä»¥é€šè¿‡ Ant Design çš„ ConfigProvider ç»„ä»¶è®¾ç½®ã€‚

## 8. Ant Design ä¸»é¢˜åˆ‡æ¢

å› ä¸ºé¡¹ç›®ä¸­ä½¿ç”¨äº† Ant Design ç»„ä»¶åº“ï¼Œæ‰€ä»¥éœ€è¦å¯¹ Ant Design çš„ä¸»é¢˜è¿›è¡Œåˆ‡æ¢ã€‚Ant Design æä¾›äº† `ConfigProvider` ç»„ä»¶ï¼Œå¯ä»¥æ–¹ä¾¿åœ°åˆ‡æ¢ä¸»é¢˜`theme`ã€‚æˆ‘ä»¬ä½¿ç”¨é¢„è®¾ç®—æ³• `algorithm` æ¥åˆ‡æ¢ä¸»é¢˜ã€‚


```tsx
const App = () => {
  const { isDark, primary, isHappy, componentSize, compactAlgorithm, borderRadius } = useSelector(
    (state: RootState) => ({
      isDark: state.global.isDark,
      primary: state.global.primary,
      isHappy: state.global.isHappy,
      componentSize: state.global.componentSize,
      compactAlgorithm: state.global.compactAlgorithm,
      borderRadius: state.global.borderRadius,
      language: state.global.language
    }),
    shallowEqual
  );

  // åˆå§‹åŒ–ä¸»é¢˜ç®—æ³•
  const algorithm = () => {
    const algorithmArr = isDark ? [theme.darkAlgorithm] : [theme.defaultAlgorithm];
    if (compactAlgorithm) algorithmArr.push(theme.compactAlgorithm);
    return algorithmArr;
  };
  return (
    <ConfigProvider       
      componentSize={componentSize} 
      theme={{
        token: { colorPrimary: primary, borderRadius },
        algorithm: algorithm()
      }}
    >
      <HappyProvider disabled={!isHappy}>
        <AppProvider>
          <RouterProvider />
        </AppProvider>
      </HappyProvider>
    </ConfigProvider>
  )
}
```

## 9. æ€»ç»“

é€šè¿‡ä»¥ä¸Šæ­¥éª¤ï¼Œæˆ‘ä»¬å®ç°äº†ä¸»é¢˜é…ç½®åŠŸèƒ½ã€‚ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œè°ƒæ•´å„ç§ä¸»é¢˜ç›¸å…³çš„é…ç½®ï¼ŒåŒ…æ‹¬æš—é»‘æ¨¡å¼ã€ä¸»é¢˜è‰²ã€ç°è‰²æ¨¡å¼ç­‰ã€‚è¿™äº›é…ç½®éƒ½ä¼šä¿å­˜åœ¨æœ¬åœ°å­˜å‚¨ä¸­ï¼Œå³ä½¿åˆ·æ–°é¡µé¢ä¹Ÿèƒ½ä¿æŒä¸€è‡´ã€‚ç”¨æˆ·ä¸éœ€è¦æ¯æ¬¡è¿›å…¥ç³»ç»Ÿéƒ½é‡æ–°è®¾ç½®ã€‚


