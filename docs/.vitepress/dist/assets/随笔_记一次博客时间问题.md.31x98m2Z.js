import{_ as i,c as a,aE as t,o as e}from"./chunks/framework.jiGApQmY.js";const n="/assets/vlog_1.DfbzAyRI.png",l="/assets/vlog_2.CtzZAyxq.png",p="/assets/vlog_3.DCNJfT3Z.png",y=JSON.parse('{"title":"记一次博客时间显示问题","description":"","frontmatter":{},"headers":[],"relativePath":"随笔/记一次博客时间问题.md","filePath":"随笔/记一次博客时间问题.md"}'),h={name:"随笔/记一次博客时间问题.md"};function k(o,s,d,c,r,g){return e(),a("div",null,s[0]||(s[0]=[t('<h1 id="记一次博客时间显示问题" tabindex="-1">记一次博客时间显示问题 <a class="header-anchor" href="#记一次博客时间显示问题" aria-label="Permalink to &quot;记一次博客时间显示问题&quot;">​</a></h1><p>搭建的博客，文章列表时间显示不正确，每一次更新都是固定显示前八小时。在翻阅了主题配置文档后，发现也是没有问题。但固定8小时前，让我想到了 UTC +8 -8 的问题，于是将问题锁定在部署机器时区问题上。</p><p><img src="'+n+'" alt="Excel Image"><img src="'+l+'" alt="Excel Image"><img src="'+p+`" alt="Excel Image"></p><p>经过 Google 和 GitHub Pages 文档，发现 GitHub Actions 部署时，默认使用 UTC 时间，需要手动设置时区为 Asia/Shanghai。</p><p>时区的问题解决后，发现所有文件的更新时间都是一样的，检查了 <code>git log</code> 文件更新，发现 Git 并没有问题。因为上一个问题也是 yml 脚本部署的问题，基本开始排查 yml 脚本。发现 yml 脚本中，设置 <code>fetch-depth: 0</code>，导致文件更新时间不正确。</p><h2 id="解决方案" tabindex="-1">解决方案 <a class="header-anchor" href="#解决方案" aria-label="Permalink to &quot;解决方案&quot;">​</a></h2><ol><li><p><strong>设置时区：</strong></p><p>在 <code>deploy.yml</code> 中通过设置环境变量 <code>TZ</code> 为 <code>Asia/Shanghai</code>，确保构建环境使用东八区时间。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Set Timezone</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">echo &quot;TZ=&#39;Asia/Shanghai&#39;&quot; &gt;&gt; $GITHUB_ENV</span></span></code></pre></div></li><li><p><strong>确保完整的 Git 历史：</strong></p><p>在 <code>actions/checkout</code> 步骤中，设置 <code>fetch-depth</code> 为 <code>0</code>，以确保获取完整的 Git 历史，从而正确读取文件的最后修改时间。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Checkout</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  uses</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">actions/checkout@v4</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  with</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">    fetch-depth</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span></span></code></pre></div></li><li><p><strong>调试和验证：</strong></p><p>在构建过程中添加调试输出，确认时区设置和 Git 信息读取是否正确，方便排查问题。</p><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Check Current Time</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">date</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">- </span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">name</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">Check File Git Info</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">git log -1 -- &lt;file_name&gt;</span></span></code></pre></div></li></ol><h2 id="总结" tabindex="-1">总结 <a class="header-anchor" href="#总结" aria-label="Permalink to &quot;总结&quot;">​</a></h2><p>此次的问题主要是 yml 脚本部署问题，因为对 yml 脚本不熟悉，导致问题排查困难。</p>`,9)]))}const m=i(h,[["render",k]]);export{y as __pageData,m as default};
